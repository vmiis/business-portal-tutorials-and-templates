<section>
      VmInclude:__BASE__/vmiis/Common-Code/frame/excel_v2.html
</section>
<script>
    function F__ID(){
        //-------------------------------------
        _fields="Local_ID,Visit,Choose,Document,Description"; /*,Reference|UID";*/
        _fields+=",Submit Date|DateTime,Submitted by|Author";
        //-------------------------------------
        VmInclude:__BASE__/vmiis/Common-Code/frame/excel_v2.js

        _table_process=function(table){
            table.Choose={width:100, renderer:function(instance, td, row, col, prop, value, cellProperties){
                if( $(td).html()!=="") return td;
                $vm.set_file_input({td:td,filename_field:"Document",callback:function(file){
                    var date=$vm.date_to_string_dmy(new Date(file.lastModified));
                    _records[row].Document=file.name;
                    _records[row].vm_dirty=1;
                    $('#save__ID').css('background','#E00');
                    $("#excel__ID").handsontable("setDataAtCell", row, col+1, file.name);
                }});
                //--------------------------------------
                return td;
            }};
            //-------------------------------------
            table.Document={width:200,readOnly:true,renderer:function(instance, td, row, col, prop, value, cellProperties){
                if(_records[row]!==undefined){
                    $vm.file_link({td:td,rid:_records[row].ID,value:value});
                }
                return td;
            }};
            //-------------------------------------
            table.lastModified={readOnly:true};
            table.Size={readOnly:true};
            //-------------------------------------
        }
        //-------------------------------------
        $('#D__ID').on('load',function(){ _set_req(); _request_data(); })
        //-------------------------------------
    }
</script>
<style>
    VmInclude:__BASE__/vmiis/Common-Code/toolbar/toolbar_for_excel.css
    #D__ID{
        font-size:14px;
        font-family: Helvetica, Arial, sans-serif;
    }
</style>
